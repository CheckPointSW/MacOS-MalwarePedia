---
layout: post
title: XAgent
date: 2019-03-18
year: 2017
categories: ["Trojan", "Backdoor"]
author: "Ofer Caspi @shablolForce (CP Research)"
hashes: ["70a1c4ed3a09a44a41d54c4fd4b409a5fc3159f6"]
---
Another macOS malware developed by the Sofacy group (APT28). The malware can handle various commands from its C&C such as download and execute files, take screenshots, collect information from system and capture keystrokes. Below we can see the command the malware can receive from its C2:

![](/assets/images/XAgent/xagent_1.jpg)

*Source: PaloAlto*

<br />

To communicate, the malware uses a POST request in order to send data to the attacker and a GET request to receive commands. For communication encryption it uses RC4:

![](/assets/images/XAgent/xagent_2.jpg)

*Source: PaloAlto*

<br />

To capture a user’s keystrokes, the malware is using CGEventTapCreate  API and will send the captured keys to the C&C every 50 keystrokes.

![](/assets/images/XAgent/xagent_3.jpg)

*Source: PaloAlto*

<br />


**Links:**

- [XAgentOSX: Sofacy’s XAgent macOS Tool](https://unit42.paloaltonetworks.com/unit42-xagentosx-sofacys-xagent-macos-tool/){:target="_blank"}



