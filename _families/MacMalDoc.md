---
layout: post
title: MacMalDoc
date: 2019-03-18
year: 2018
categories: ["Backdoor"]
author: "Ofer Caspi @shablolForce (CP Research)"
hashes: ["70778374164075298aba2194c0c7bb1d08bde7f4"]
---
MalDoc is the first malware threat for MacOS that exploits MS Office for Mac to infect the system.The malware uses a [POC code published by Adam Chester](https://www.mdsec.co.uk/2018/08/escaping-the-sandbox-microsoft-office-on-macos/){:target="_blank"} that escapes MS Office sandbox to write a malicious file on the system.When opened, if macros are enabled on MS Office, a malicious script will be executed to escape the Office sandbox, to create a file on the system. In this case, the create file is a LaunchAgent, that will execute a python script to download the final payload:

![](/assets/images/MacMalDoc/macmaldoc_1.png)

<br />

![](/assets/images/MacMalDoc/macmaldoc_2.png)

<br />

The final payload is “Metapreter”, a python script that is generated by Metasploit and will open the door to a lot of malicious commands.

<br />

**Links:**

- [Analyzing a malicious word document targeting macOS users](https://objective-see.com/blog/blog_0x3A.html){:target="_blank"}

