---
layout: post
title: FairyTale
date: 2019-03-18
year: 2018
categories: ["Adware"]
author: "Ofer Caspi @shablolForce (CP Research)"
hahses: ["4eaa4caea4ac543516ffc9954a901e8b8e8c623fcce48304ea74d7a74218683b"]
---
FairyTale is an adware that uses malware techniques in order to avoid detection. FairyTale’s application bundle arrived as signed with a legitimate Apple Developer ID, which has since been revoked:

![](/assets/images/FairyTale/fairytale_1.png)

<br />

When executed, the adware will use the xattr command in order to remove its quarantine attribute which is used to identify files that were downloaded from the internet. XProtect, the built in macOS anti-malware only scans files with a quarantine attribute, so that it might download additional files and modify the attributes to avoid XProtect detection.

![](/assets/images/FairyTale/fairytale_2.png)

<br />

In addition it will check if its not executed within a virtual machine and if there is any anti-malware product installed on the machine:

![](/assets/images/FairyTale/fairytale_3.png)

<br />

To survive a system reboot, the malware will create the LaunchAgent “~/Library/LaunchAgents/com.sysd.launchserviced.plist”.FairyTale will modify the default home page and redirect the browser through several pages.

<br />

**Links:**

- [ON THE TRAIL OF OSX.FAIRYTALE \| ADWARE PLAYING AT MALWARE](https://www.sentinelone.com/blog/trail-osx-fairytale-adware-playing-malware/){:target="_blank"}

