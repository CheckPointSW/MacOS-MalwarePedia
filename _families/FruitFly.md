---
layout: post
title: FruitFly
date: 2019-03-18
year: 2017
categories: ["Trojan", "Backdoor"]
author: "Ofer Caspi @shablolForce (CP Research)"
---
Discovered by Malwarebytes in the early days of 2017. The malware written in perl (obfuscated), includes a “__DATA__” part that when decoded is a mach-o file that will be executed on an infected machine.

![](/assets/images/FruitFly/fruitfly_1.png)

*Source: CheckPoint*

<br />

The malware can take screenshots using the command “screencapture -x” and in addition the malware downloads and executes additional files such to enable it to scan for other computers on the same network and connect to them. Below we can see the set of commands the malware can receive from the C&C for FruitFly variants A and B as analyzed by Patric Wardle (full report in link2)

![](/assets/images/FruitFly/fruitfly_2.jpg)

*Source: Patrick Wardle*

<br />

![](/assets/images/FruitFly/fruitfly_3.jpg)

*Source: Patrick Wardle*

<br />


**Links:**

- [New Mac backdoor using antiquated code](https://blog.malwarebytes.com/threat-analysis/2017/01/new-mac-backdoor-using-antiquated-code/){:target="_blank"}
- [Dissecting OSX/FruitFly via custom C&C Server](https://speakerdeck.com/patrickwardle/fruitfly-via-a-custom-c-and-c-server){:target="_blank"}


<br />
