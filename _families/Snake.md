---
layout: post
title: Snake
date: 2019-03-18
year: 2017
categories: ["Trojan"]
author: "Ofer Caspi @shablolForce (CP Research)"
hashes: ["b8ee4556dc09b28826359b98343a4e00680971a6f8c6602747bd5d723d26eaea"]
---
Snake is a known malware on Windows OS since 2008. In 2017 fox-it found a variant of this malware that was ported to macOS.The malware arrived as the file “Install Adobe Flash Player.zip” which is a modify version of Adobe Flash installation. Within the zip file there is a macOs application bundle signed with a legitimate Apple Developer ID (revoked already):

![](/assets/images/Snake/snake_1.png)

*Source: CheckPoint*

<br />

Once executed the malware will execute its script first prior the real Adobe installation. It will use AppleScript in order to execute its infection script with administrator permissions:

![](/assets/images/Snake/snake_2.jpg)

*Source: CheckPoint*

<br />

The infection vector contains two scripts. The first will copy the malware files to target locations “/Library/Scripts/” and create a LaunchDaemon in order to persist on the system.

![](/assets/images/Snake/snake_3.jpg)

*Source: CheckPoint*

<br />

The second script “installd.sh” will check if “installdp” process is running, and if not, will execute it.It is unknown what the infection vector is, if any infection was there at all. From the malicious binary file “installdp” it might be implied that this version of the malware is not finished as there are a lot of debug strings:

![](/assets/images/Snake/snake_4.jpg)

*Source: CheckPoint*

<br />

**Links:**

- [Snake: Coming soon in Mac OS X flavour](https://blog.fox-it.com/2017/05/03/snake-coming-soon-in-mac-os-x-flavour/){:target="_blank"}
