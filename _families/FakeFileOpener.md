---
layout: post
title: FakeFileOpener
date: 2019-03-18
year: 2016
categories: ["Trojan"]
author: "Ofer Caspi @shablolForce (CP Research)"
hashes: ["7819ae7d72fa045baa77e9c8e063a69df439146b27f9c3bb10aef52dcc77c145"]
---
FakeFileOpened is a nasty application that sets itself as a “File Opener” application for over 200 file types in macOS includes video, gifs, java files and many more. this is done by configuring all the file types in its Info.plist file:

![](/assets/images/FakeFileOpener/fakefileopener_1.jpg)

*Source: CheckPoint*

<br />

The key “CFBundleTypeExtensions” declares the file type to reference to, and the key “LSHandlerRank” is set to “Alternate”. This means that FakeFileOpener will be the default handling application for specified file types only if there is no other application that was declared as “Owner” or “Default”.

![](/assets/images/FakeFileOpener/fakefileopener_2.jpg)

*Source: CheckPoint*

<br />

Once such a file is opened, FakeFileOpener will be opened. then it will show the window below, saying there is no program installed that can handle this kind of file, and the user can search on the web.

![](/assets/images/FakeFileOpener/fakefileopener_3.png)

*Source: CheckPoint*

<br />

When the user will click “Search Web” a web page with adwares / fake applications will be opened suggesting to handle the file:

![](/assets/images/FakeFileOpener/fakefileopener_4.png)

*Source: CheckPoint*

<br />

Need to mention that in a normal case that there are file types with no default application to handle it, the OS will show the message below:

![](/assets/images/FakeFileOpener/fakefileopener_5.png)

*Source: CheckPoint*

<br />

**Links:**

- [PCVARK plays dirty](https://blog.malwarebytes.com/threat-analysis/2016/08/pcvark-plays-dirty/){:target="_blank"}


