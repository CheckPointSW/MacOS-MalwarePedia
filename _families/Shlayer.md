---
layout: post
title: Shlayer
date: 2019-03-18
year: 2018
categories: ["Trojan"]
author: "Ofer Caspi @shablolForce (CP Research)"
hashes: ["79f22a59805513799ee631d4e61ca309a2057709"]
---
Like many others MacOS malwares, OSX/Shlayer distributes as a fake Flash Player. That might be via a torrent, or a fake pop up alert telling the user they needs to update their Flash in order to view content on malicious/compromised web sites. The malware is signed with a legitimate Apple certificate.

![](/assets/images/Shlayer/shlayer_1.jpg)

*Source: CheckPoint*

<br />

The malware executes a small shell script to decrypt other scripts that are located in the Resources folder (“Resources/enc”).

![](/assets/images/Shlayer/shlayer_2.png)

*Source: CheckPoint*

<br />

After decryption, the final shell script it execute looks like the below. What does the malware actually do? It downloads additional files/malware and executes them on the system using the curl command:

![](/assets/images/Shlayer/shlayer_3.jpg)

*Source: CheckPoint*

<br />

**Links:**

- [New OSX/Shlayer Malware Variant Found Using a Dirty New Trick](https://www.intego.com/mac-security-blog/new-osxshlayer-malware-variant-found-using-a-dirty-new-trick/){:target="_blank"}

